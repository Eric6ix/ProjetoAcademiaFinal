generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

// Definindo o Enum para o Role
enum Role {
  ALUNO
  FUNCIONARIO
  ADMIN
}

model User {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  role        Role // Agora o tipo é o Enum
  name        String
  email       String    @unique
  phone       String
  peso        Float
  dataContra  DateTime? // Data do contrato
  dataNasc    DateTime
  UserCriacao DateTime  @default(now())
  UserEdicao  DateTime  @updatedAt
  password    String
}

model Produto {
  id             String          @id @default(auto()) @map("_id") @db.ObjectId
  name           String
  preco          Float
  descricao      String?
  dataVal        DateTime        @default(now())
  dataFab        DateTime        @updatedAt
  compras        CompraProduto[]
  ProdutoCriacao DateTime        @default(now())
  ProdutoEdicao  DateTime        @updatedAt
}

model Compra {
  id      String          @id @default(auto()) @map("_id") @db.ObjectId
  date    DateTime        @default(now())
  total   Float
  estado  String // Ex: 'pendente', 'concluída'
  produto CompraProduto[]
}

model CompraProduto {
  id         String   @id @default(auto()) @map("_id") @db.ObjectId
  compraId   String   @map("compra_id") @db.ObjectId
  produtoId  String   @map("produto_id") @db.ObjectId
  quantidade Int
  preco      Float
  compra     Compra   @relation(fields: [compraId], references: [id])
  produto    Produto  @relation(fields: [produtoId], references: [id])
  diacompra  DateTime @default(now())
}
